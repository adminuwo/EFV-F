<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Dashboard | EFV™</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/animations.css">
    <link rel="stylesheet" href="css/dashboard.css">
    <link rel="stylesheet" href="css/dashboard-v2.css">
    <link rel="stylesheet" href="css/admin-modal.css">
    <link rel="stylesheet" href="css/reader.css">
    <link rel="stylesheet" href="css/security.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <!-- PDF.js for Library Access -->
    <script src="js/pdfjs/pdf.min.js"></script>
    <script src="js/efv-pdf-data.js"></script>
</head>

<body class="dashboard-body">

    <div class="dashboard-container">
        <!-- LEFT SIDEBAR -->
        <aside class="sidebar glass-panel">
            <div class="sidebar-header">
                <a href="index.html" class="logo">
                    <img src="img/AISA.svg" alt="EFV Logo">
                    <span>EFV<sup>TM</sup></span>
                </a>
            </div>

            <!-- User Profile Summary (NEW) -->
            <div class="user-profile-sm">
                <div class="avatar-container">
                    <img src="img/default-avatar.png" alt="User Avatar" id="sidebar-avatar"
                        onerror="this.src='https://ui-avatars.com/api/?name=User&background=D4AF37&color=fff'">
                    <div class="status-indicator online"></div>
                </div>
                <div class="user-info">
                    <h4 id="sidebar-user-name">Guest User</h4>
                    <span class="membership-badge" id="sidebar-membership">Standard</span>
                </div>
            </div>

            <nav class="sidebar-nav">
                <a href="marketplace.html" class="nav-item" id="nav-back-to-shop">
                    <i class="fas fa-shopping-bag"></i> <span>Browse Store</span>
                </a>
                <button class="nav-item active" data-tab="dashboard">
                    <i class="fas fa-th-large"></i> <span>Dashboard</span>
                </button>
                <button class="nav-item" data-tab="cart">
                    <i class="fas fa-shopping-cart"></i> <span>Cart Items</span>
                    <span id="sidebar-cart-count" class="badge hidden">0</span>
                </button>
                <button class="nav-item" data-tab="orders">
                    <i class="fas fa-box-open"></i> <span>My Orders</span>
                </button>
                <button class="nav-item" data-tab="library">
                    <i class="fas fa-book-reader"></i> <span>My Library</span>
                </button>
                <button class="nav-item" data-tab="wishlist" style="display: none;">
                    <i class="fas fa-heart"></i> <span>Wishlist</span>
                </button>
                <button class="nav-item" data-tab="notifications">
                    <i class="fas fa-bell"></i> <span>Notifications</span>
                    <span id="unread-notifications-count" class="badge red hidden">0</span>
                </button>
                <button class="nav-item" onclick="switchTab('settings', 'addresses-tab')">
                    <i class="fas fa-map-marker-alt"></i> <span>Saved Addresses</span>
                </button>
                <button class="nav-item" onclick="switchTab('settings', 'payments-tab')">
                    <i class="fas fa-credit-card"></i> <span>Payments & Billing</span>
                </button>
                <button class="nav-item" data-tab="settings">
                    <i class="fas fa-cog"></i> <span>Account Settings</span>
                </button>
                <button class="nav-item" data-tab="support">
                    <i class="fas fa-headset"></i> <span>Help & Support</span>
                </button>

                <!-- Admin Items -->
                <button class="nav-item hidden" data-tab="admin" id="sidebar-admin-btn">
                    <i class="fas fa-user-shield"></i> <span>Admin Portal</span>
                </button>
                <button class="nav-item admin-nav hidden" data-tab="admin-orders">
                    <i class="fas fa-shopping-basket"></i> <span>Orders Management</span>
                </button>
                <button class="nav-item admin-nav hidden" data-tab="admin-products">
                    <i class="fas fa-book-medical"></i> <span>Product Management</span>
                </button>
                <button class="nav-item admin-nav hidden" data-tab="admin-customers">
                    <i class="fas fa-users-cog"></i> <span>Customers</span>
                </button>
                <button class="nav-item admin-nav hidden" data-tab="admin-payments">
                    <i class="fas fa-file-invoice-dollar"></i> <span>Payments</span>
                </button>
                <button class="nav-item admin-nav hidden" data-tab="admin-shipments">
                    <i class="fas fa-shipping-fast"></i> <span>Shipments</span>
                </button>
                <button class="nav-item admin-nav hidden" data-tab="admin-coupons">
                    <i class="fas fa-ticket-alt"></i> <span>Coupons</span>
                </button>


                <div style="margin-top: auto; padding-top: 20px;">
                    <button class="nav-item" id="sidebar-logout-btn-v2"
                        style="color: #ff4d4d; width: 100%; text-align: left;" onclick="logoutAction()">
                        <i class="fas fa-sign-out-alt"></i> <span>Sign Out</span>
                    </button>
                </div>
            </nav>
        </aside>

        <!-- RIGHT CONTENT AREA -->
        <main class="main-content">

            <!-- ADMIN DASHBOARD OVERVIEW TAB -->
            <section id="dashboard" class="content-section active">
                <header class="content-header">
                    <div class="welcome-text">
                        <h1 class="gradient-text">Admin <span class="gold-text">Command Center</span></h1>
                        <p>System Overview & Business Intelligence</p>
                    </div>
                    <div class="date-display" id="current-date"></div>
                </header>

                <!-- Admin KPI Cards -->
                <div class="stats-grid" style="grid-template-columns: repeat(4, 1fr); gap: 20px; margin-bottom: 30px;">
                    <button class="stat-card glass-panel shine-hover" onclick="switchTab('admin-orders')">
                        <div class="icon-box gold"><i class="fas fa-shopping-bag"></i></div>
                        <div class="stat-info">
                            <h3>Total Orders</h3>
                            <span id="admin-stat-total-orders" class="stat-value">--</span>
                        </div>
                    </button>
                    <button class="stat-card glass-panel shine-hover" onclick="switchTab('admin-products')">
                        <div class="icon-box blue"><i class="fas fa-boxes"></i></div>
                        <div class="stat-info">
                            <h3>Products</h3>
                            <span id="admin-stat-total-products" class="stat-value">--</span>
                        </div>
                    </button>
                    <div class="stat-card glass-panel">
                        <div class="icon-box green"><i class="fas fa-rupee-sign"></i></div>
                        <div class="stat-info">
                            <h3>Total Revenue</h3>
                            <span id="admin-stat-revenue" class="stat-value">₹0</span>
                        </div>
                    </div>
                    <div class="stat-card glass-panel">
                        <div class="icon-box red"><i class="fas fa-users"></i></div>
                        <div class="stat-info">
                            <h3>Active Users</h3>
                            <span id="admin-stat-users" class="stat-value">--</span>
                        </div>
                    </div>
                </div>

                <!-- Admin Quick Actions -->
                <h3 style="margin-bottom: 15px; border-bottom: 1px solid rgba(255,255,255,0.1); padding-bottom: 10px;">
                    Quick Management</h3>
                <div class="quick-actions-grid"
                    style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 40px;">
                    <button class="stat-card glass-panel shine-hover" onclick="openAddProductModal()"
                        style="cursor: pointer; padding: 20px; align-items: center; justify-content: flex-start; gap: 15px; color: #fff;">
                        <div class="icon-box gold" style="width: 45px; height: 45px; font-size: 1.1rem;"><i
                                class="fas fa-plus"></i></div>
                        <span style="font-weight: 600;">Add New Product</span>
                    </button>
                    <button class="stat-card glass-panel shine-hover" onclick="switchTab('admin-orders')"
                        style="cursor: pointer; padding: 20px; align-items: center; justify-content: flex-start; gap: 15px; color: #fff;">
                        <div class="icon-box blue" style="width: 45px; height: 45px; font-size: 1.1rem;"><i
                                class="fas fa-shipping-fast"></i></div>
                        <span style="font-weight: 600;">Manage Shipments</span>
                    </button>
                    <button class="stat-card glass-panel shine-hover" onclick="switchTab('admin-settings')"
                        style="cursor: pointer; padding: 20px; align-items: center; justify-content: flex-start; gap: 15px; color: #fff;">
                        <div class="icon-box green" style="width: 45px; height: 45px; font-size: 1.1rem;"><i
                                class="fas fa-sliders-h"></i></div>
                        <span style="font-weight: 600;">Store Configuration</span>
                    </button>
                    <button class="stat-card glass-panel shine-hover" onclick="alert('Feature coming in v2.0')"
                        style="cursor: pointer; padding: 20px; align-items: center; justify-content: flex-start; gap: 15px; opacity: 0.6; color: #fff;">
                        <div class="icon-box red" style="width: 45px; height: 45px; font-size: 1.1rem;"><i
                                class="fas fa-bullhorn"></i></div>
                        <span style="font-weight: 600;">Create Announcement</span>
                    </button>
                </div>

                <!-- Recent Activity Log (Admin View) -->
                <div class="dashboard-grid-2" style="display: grid; grid-template-columns: 2fr 1fr; gap: 30px;">
                    <div class="glass-panel" style="padding: 25px;">
                        <h3 style="margin: 0 0 20px;"><i class="fas fa-clipboard-list gold-text"></i> Recent System
                            Activity</h3>
                        <div class="mini-list" id="admin-activity-log">
                            <div
                                style="display: flex; justify-content: space-between; padding: 10px 0; border-bottom: 1px solid rgba(255,255,255,0.05);">
                                <span>System initialized successfully</span>
                                <span class="fade-text" style="font-size: 0.8rem;">Just now</span>
                            </div>
                            <div
                                style="display: flex; justify-content: space-between; padding: 10px 0; border-bottom: 1px solid rgba(255,255,255,0.05);">
                                <span>Admin login detected (IP: 192.168.1.1)</span>
                                <span class="fade-text" style="font-size: 0.8rem;">2 mins ago</span>
                            </div>
                            <div
                                style="display: flex; justify-content: space-between; padding: 10px 0; border-bottom: 1px solid rgba(255,255,255,0.05);">
                                <span>Daily Backup completed</span>
                                <span class="fade-text" style="font-size: 0.8rem;">1 hr ago</span>
                            </div>
                        </div>
                    </div>

                    <div class="glass-panel" style="padding: 25px;">
                        <h3 style="margin: 0 0 20px;"><i class="fas fa-server gold-text"></i> Server Status</h3>
                        <div style="display: flex; flex-direction: column; gap: 15px;">
                            <div>
                                <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                    <span style="font-size: 0.9rem;">API Latency</span>
                                    <span style="color: #2ecc71;">45ms</span>
                                </div>
                                <div class="progress-bar-bg"
                                    style="background: rgba(255,255,255,0.1); height: 6px; border-radius: 3px;">
                                    <div style="width: 15%; background: #2ecc71; height: 100%; border-radius: 3px;">
                                    </div>
                                </div>
                            </div>
                            <div>
                                <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                    <span style="font-size: 0.9rem;">Database Load</span>
                                    <span style="color: var(--gold-text);">12%</span>
                                </div>
                                <div class="progress-bar-bg"
                                    style="background: rgba(255,255,255,0.1); height: 6px; border-radius: 3px;">
                                    <div
                                        style="width: 12%; background: var(--gold-text); height: 100%; border-radius: 3px;">
                                    </div>
                                </div>
                            </div>
                            <div>
                                <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                    <span style="font-size: 0.9rem;">Storage Usage</span>
                                    <span>64%</span>
                                </div>
                                <div class="progress-bar-bg"
                                    style="background: rgba(255,255,255,0.1); height: 6px; border-radius: 3px;">
                                    <div style="width: 64%; background: #3498db; height: 100%; border-radius: 3px;">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- CART ITEMS TAB -->
            <section id="cart" class="content-section">
                <header class="content-header">
                    <div>
                        <h1>Shopping <span class="gold-text">Cart</span></h1>
                        <p id="cart-item-count-text">0 items in your cart</p>
                    </div>
                </header>

                <div class="cart-layout-grid" style="display: grid; grid-template-columns: 2fr 1fr; gap: 30px;">
                    <div class="cart-items-panel">
                        <div id="dashboard-cart-list" class="items-list"
                            style="display: flex; flex-direction: column; gap: 20px;">
                            <!-- Cart Items Injected Here -->
                            <div class="skeleton" style="height: 120px; border-radius: 12px;"></div>
                            <div class="skeleton" style="height: 120px; border-radius: 12px;"></div>
                        </div>

                        <div id="cart-empty-state" class="empty-state hidden">
                            <i class="fas fa-shopping-cart"></i>
                            <h3>Your cart is empty</h3>
                            <a href="marketplace.html" class="btn btn-gold">Browse Marketplace</a>
                        </div>
                    </div>

                    <div class="cart-summary-panel">
                        <div class="glass-panel checkout-summary-panel">
                            <h3 style="margin: 0 0 20px;">Order Summary</h3>

                            <div class="summary-details">
                                <div class="summary-row">
                                    <span>Subtotal</span>
                                    <span id="cart-subtotal">₹0.00</span>
                                </div>
                                <div class="summary-row">
                                    <span>Estimated Shipping</span>
                                    <span id="cart-shipping">₹0.00</span>
                                </div>
                                <div class="summary-row">
                                    <span>Tax (GST)</span>
                                    <span id="cart-tax">₹0.00</span>
                                </div>
                                <div class="summary-row" id="cart-discount-row" style="color: #10b981; display: none;">
                                    <span>Discount</span>
                                    <span id="cart-discount">-₹0.00</span>
                                </div>
                                <div class="summary-row total">
                                    <span>Grand Total</span>
                                    <span id="cart-grand-total">₹0.00</span>
                                </div>
                            </div>

                            <div class="coupon-section"
                                style="margin-top: 25px; padding-top: 20px; border-top: 1px solid rgba(255,255,255,0.05);">
                                <label
                                    style="display: block; font-size: 0.8rem; margin-bottom: 8px; opacity: 0.6;">Apply
                                    Coupon</label>
                                <div class="input-wrapper" style="margin-bottom: 20px;">
                                    <input type="text" id="cart-coupon-input" placeholder="Enter Code"
                                        style="padding-right: 80px;">
                                    <button class="btn btn-gold small" id="apply-coupon-btn"
                                        style="position: absolute; right: 5px; top: 5px; height: 35px; width: 70px;">Apply</button>
                                </div>
                            </div>

                            <button class="btn btn-gold full-width" id="proceed-to-checkout-btn"
                                style="height: 55px; font-size: 1.1rem; font-weight: 700;">
                                Proceed to Checkout <i class="fas fa-arrow-right" style="margin-left: 10px;"></i>
                            </button>

                            <div style="margin-top: 15px; text-align: center; font-size: 0.75rem; opacity: 0.5;">
                                <i class="fas fa-shield-alt"></i> Secure checkout powered by Razorpay
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- MY ORDERS TAB -->
            <section id="orders" class="content-section">
                <header class="content-header" style="justify-content: space-between; align-items: center;">
                    <div>
                        <h1>My <span class="gold-text">Orders</span></h1>
                        <p>Track, manage and download invoices</p>
                    </div>
                    <div class="search-box" style="width: 250px; position: relative;">
                        <input type="text" id="order-search" placeholder="Search orders..."
                            style="width: 100%; padding: 10px 15px 10px 40px; background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1); border-radius: 8px; color: white;">
                        <i class="fas fa-search"
                            style="position: absolute; left: 15px; top: 50%; transform: translateY(-50%); opacity: 0.5;"></i>
                    </div>
                </header>

                <!-- Filter Tabs -->
                <div class="settings-tabs" style="margin-bottom: 25px;">
                    <button class="settings-tab-btn active" data-order-filter="all">All Orders</button>
                    <button class="settings-tab-btn" data-order-filter="processing">Processing</button>
                    <button class="settings-tab-btn" data-order-filter="shipped">Shipped</button>
                    <button class="settings-tab-btn" data-order-filter="delivered">Delivered</button>
                    <button class="settings-tab-btn" data-order-filter="cancelled">Cancelled</button>
                </div>

                <div id="dashboard-orders-list" class="orders-list">
                    <!-- Skeleton -->
                    <div class="skeleton" style="height: 150px; border-radius: 12px; margin-bottom: 20px;"></div>
                    <div class="skeleton" style="height: 150px; border-radius: 12px;"></div>
                </div>

                <div id="orders-empty-state" class="empty-state hidden">
                    <i class="fas fa-box-open"></i>
                    <h3>No orders found</h3>
                    <p>You haven't placed any orders in this category yet.</p>
                    <a href="marketplace.html" class="btn btn-gold" style="margin-top: 20px;">Start Shopping</a>
                </div>
            </section>

            <!-- MY LIBRARY TAB -->
            <section id="library" class="content-section">
                <header class="content-header"
                    style="display: flex; justify-content: space-between; align-items: center;">
                    <div>
                        <h1>My <span class="gold-text">Library</span></h1>
                        <p>Your digital collection & reading progress</p>
                    </div>
                    <div style="display: flex; gap: 10px;">
                        <div class="search-box" style="width: 200px; position: relative;">
                            <input type="text" id="library-search" placeholder="Search library..."
                                style="width: 100%; padding: 8px 12px 8px 35px; background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1); border-radius: 8px; color: white; font-size: 0.85rem;">
                            <i class="fas fa-search"
                                style="position: absolute; left: 12px; top: 50%; transform: translateY(-50%); opacity: 0.5;"></i>
                        </div>
                        <button class="btn btn-outline small" onclick="syncLibraryWithBackend()"
                            style="width: auto; padding: 0 15px;">
                            <i class="fas fa-sync-alt"></i> Sync
                        </button>
                    </div>
                </header>

                <div id="dashboard-library-list" class="items-grid">
                    <!-- Skeleton -->
                    <div class="skeleton" style="height: 350px; border-radius: 16px;"></div>
                    <div class="skeleton" style="height: 350px; border-radius: 16px;"></div>
                    <div class="skeleton" style="height: 350px; border-radius: 16px;"></div>
                </div>

                <div id="library-empty-state" class="empty-state hidden">
                    <i class="fas fa-book-open"></i>
                    <h3>Library is empty</h3>
                    <p>Purchase digital products (E-books or Audiobooks) to see them here.</p>
                    <a href="marketplace.html" class="btn btn-gold" style="margin-top: 20px;">Explore Digital Books</a>
                </div>
            </section>


            <!-- NOTIFICATIONS TAB -->
            <section id="notifications" class="content-section">
                <header class="content-header"
                    style="display: flex; justify-content: space-between; align-items: center;">
                    <div>
                        <h1>Account <span class="gold-text">Notifications</span></h1>
                        <p>Stay updated on orders and activity</p>
                    </div>
                </header>

                <!-- Filter Tabs -->
                <div class="settings-tabs" style="margin-bottom: 25px;">
                    <button class="settings-tab-btn active" data-notif-filter="all">All</button>
                    <button class="settings-tab-btn" data-notif-filter="orders">Orders</button>
                    <button class="settings-tab-btn" data-notif-filter="payments">Payments</button>
                    <button class="settings-tab-btn" data-notif-filter="offers">Offers</button>

                    <button class="btn btn-outline small" onclick="markAllNotificationsRead()" id="mark-all-read-btn"
                        style="margin-left: auto;">Mark all as read</button>
                </div>

                <div id="notifications-list" class="notifications-list">
                    <!-- Skeleton -->
                    <div class="skeleton" style="height: 80px; border-radius: 12px; margin-bottom: 10px;"></div>
                    <div class="skeleton" style="height: 80px; border-radius: 12px;"></div>
                </div>

                <div id="notifications-empty-state" class="empty-state hidden">
                    <i class="fas fa-bell-slash"></i>
                    <h3>No new notifications</h3>
                    <p>We'll notify you when something important happens.</p>
                </div>
            </section>

            <!-- SETTINGS TAB (RESTRUCTURED) -->
            <section id="settings" class="content-section">
                <header class="content-header">
                    <h1>Account <span class="gold-text">Center</span></h1>
                    <p>Manage your profile, security, and preferences</p>
                </header>

                <div class="settings-tabs" style="margin-bottom: 30px;">
                    <button class="settings-tab-btn active" data-settings-tab="profile-tab">Profile</button>
                    <button class="settings-tab-btn" data-settings-tab="security-tab">Security</button>
                    <button class="settings-tab-btn" data-settings-tab="addresses-tab">Addresses</button>
                    <button class="settings-tab-btn" data-settings-tab="payments-tab">Payments & Billing</button>
                </div>

                <div class="settings-content-area">
                    <!-- PROFILE TAB -->
                    <div id="profile-tab" class="settings-pane active">
                        <div class="settings-grid">
                            <div class="settings-card glass-panel" style="grid-column: span 2;">
                                <div class="profile-header-alt"
                                    style="display: flex; gap: 30px; align-items: center; margin-bottom: 30px;">
                                    <div class="avatar-upload-container" style="position: relative;">
                                        <img src="img/default-avatar.png" id="profile-avatar-large"
                                            onerror="this.src='https://ui-avatars.com/api/?name=User&background=D4AF37&color=fff'"
                                            style="width: 120px; height: 120px; border-radius: 50%; border: 3px solid var(--gold-text); object-fit: cover;">
                                        <button class="btn-icon"
                                            style="position: absolute; bottom: 0; right: 0; background: var(--gold-text); color: black;"
                                            onclick="document.getElementById('avatar-input').click()"><i
                                                class="fas fa-camera"></i></button>
                                        <input type="file" id="avatar-input" hidden accept="image/*">
                                    </div>
                                    <div class="profile-info-basic">
                                        <h2 id="profile-display-name">Guest User</h2>
                                        <p id="profile-display-email" style="opacity: 0.6;">user@example.com</p>
                                        <div id="member-status-tag" class="membership-badge premium"
                                            style="display: inline-block; margin-top: 10px;">Premium Member</div>
                                    </div>
                                </div>

                                <form id="profile-form-v2"
                                    style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                                    <div class="form-group">
                                        <label>Full Name</label>
                                        <div class="input-wrapper">
                                            <i class="fas fa-user"></i>
                                            <input type="text" id="settings-name-v2" placeholder="Your Name">
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label>Email Address</label>
                                        <div class="input-wrapper">
                                            <i class="fas fa-envelope"></i>
                                            <input type="email" id="settings-email-v2" readonly style="opacity: 0.7;">
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label>Phone Number</label>
                                        <div class="input-wrapper">
                                            <i class="fas fa-phone"></i>
                                            <input type="tel" id="settings-phone-v2" placeholder="Phone Number">
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label>Account Created</label>
                                        <div class="input-wrapper">
                                            <i class="fas fa-calendar-alt"></i>
                                            <input type="text" id="account-created-date" readonly style="opacity: 0.7;">
                                        </div>
                                    </div>
                                    <div style="grid-column: span 2; display: flex; gap: 15px; margin-top: 20px;">
                                        <button type="submit" class="btn btn-gold" style="width: 200px;">Save
                                            Changes</button>
                                        <button type="button" class="btn btn-outline" id="verify-email-btn">Verify Email
                                            (OTP)</button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>

                    <!-- SECURITY TAB -->
                    <div id="security-tab" class="settings-pane" style="display: none;">
                        <div class="settings-grid">
                            <div class="settings-card glass-panel">
                                <div class="settings-header">
                                    <div class="icon-box blue"><i class="fas fa-key"></i></div>
                                    <h3>Password Management</h3>
                                </div>
                                <form id="security-form" style="display: flex; flex-direction: column; gap: 15px;">
                                    <div class="form-group">
                                        <label>Current Password</label>
                                        <input type="password" placeholder="••••••••">
                                    </div>
                                    <div class="form-group">
                                        <label>New Password</label>
                                        <input type="password" placeholder="At least 8 characters">
                                    </div>
                                    <div class="form-group">
                                        <label>Confirm New Password</label>
                                        <input type="password" placeholder="Confirm password">
                                    </div>
                                    <button type="submit" class="btn btn-gold full-width">Update Password</button>
                                </form>
                            </div>

                            <div class="settings-card glass-panel">
                                <div class="settings-header">
                                    <div class="icon-box gold"><i class="fas fa-shield-alt"></i></div>
                                    <h3>Advanced Security</h3>
                                </div>
                                <div class="security-items-list">
                                    <div class="security-item">
                                        <div>
                                            <h4>2-Factor Authentication</h4>
                                            <p>Protect account with OTP</p>
                                        </div>
                                        <button class="btn btn-outline small">Enable</button>
                                    </div>
                                    <div class="security-item">
                                        <div>
                                            <h4>Login Activity</h4>
                                            <p>Manage active sessions</p>
                                        </div>
                                        <button class="btn btn-outline small" onclick="switchTab('admin-reports')">View
                                            History</button>
                                    </div>
                                </div>
                                <div class="settings-divider"></div>
                                <button class="btn btn-danger full-width" onclick="logoutAction()">Sign out from all
                                    devices</button>
                            </div>
                        </div>
                    </div>

                    <!-- ADDRESSES TAB -->
                    <div id="addresses-tab" class="settings-pane" style="display: none;">
                        <div class="settings-card glass-panel">
                            <div class="settings-header" style="justify-content: space-between;">
                                <div style="display: flex; align-items: center; gap: 15px;">
                                    <div class="icon-box green"><i class="fas fa-map-marked-alt"></i></div>
                                    <h3>My Addresses</h3>
                                </div>
                                <button class="btn btn-gold small" onclick="openAddressModal()">+ Add New
                                    Address</button>
                            </div>
                            <div id="saved-addresses-grid-v2"
                                style="display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 20px; margin-top: 20px;">
                                <!-- Addresses injected here -->
                                <div class="skeleton" style="height: 180px; border-radius: 12px;"></div>
                                <div class="skeleton" style="height: 180px; border-radius: 12px;"></div>
                            </div>
                        </div>
                    </div>

                    <!-- PAYMENTS TAB -->
                    <div id="payments-tab" class="settings-pane" style="display: none;">
                        <div class="settings-card glass-panel">
                            <div class="settings-header">
                                <div class="icon-box blue"><i class="fas fa-credit-card"></i></div>
                                <h3>Payment Methods & Billing</h3>
                            </div>
                            <div class="payments-empty-state" style="text-align: center; padding: 40px;">
                                <i class="fas fa-credit-card"
                                    style="font-size: 3rem; opacity: 0.1; margin-bottom: 20px;"></i>
                                <p class="fade-text">No payment methods saved. They will appear here after your first
                                    purchase.</p>
                            </div>

                            <div class="billing-history" style="margin-top: 30px;">
                                <h4>Billing History (GST Invoices)</h4>
                                <div id="billing-history-list" style="margin-top: 15px;">
                                    <p class="fade-text">No invoices found.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- ADMIN SETTINGS TAB -->
            <section id="admin-settings" class="content-section">
                <header class="content-header">
                    <h1>Control <span class="gold-text">Center</span></h1>
                    <p>System configuration & staff management</p>
                </header>

                <div class="settings-tabs admin-tab-nav"
                    style="margin-bottom: 30px; display: flex; gap: 10px; flex-wrap: wrap;">
                    <button class="settings-tab-btn active" data-admin-tab="admin-profile-pane">Admin Profile</button>
                    <button class="settings-tab-btn" data-admin-tab="admin-security-pane">Security & Logs</button>
                    <button class="settings-tab-btn" data-admin-tab="store-config-pane">Store Configuration</button>
                    <button class="settings-tab-btn" data-admin-tab="admin-alerts-pane">Notifications</button>

                </div>

                <div class="admin-settings-content">
                    <!-- ADMIN PROFILE -->
                    <div id="admin-profile-pane" class="settings-pane active">
                        <div class="settings-grid">
                            <div class="settings-card glass-panel" style="grid-column: span 2;">
                                <div style="display: flex; gap: 20px; align-items: center; margin-bottom: 30px;">
                                    <div
                                        style="width: 80px; height: 80px; background: var(--gold-text); color: black; border-radius: 15px; display: flex; align-items: center; justify-content: center; font-size: 2rem; font-weight: 700;">
                                        SA</div>
                                    <div>
                                        <h3 id="admin-full-name">Super Admin</h3>
                                        <p class="fade-text" id="admin-role-badge">Primary Administrator / Manager</p>
                                    </div>
                                </div>
                                <div class="form-grid"
                                    style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                                    <div class="form-group">
                                        <label>Admin Name</label>
                                        <input type="text" id="adm-name" class="glass-input" value="Super Admin">
                                    </div>
                                    <div class="form-group">
                                        <label>Email Address</label>
                                        <input type="email" id="adm-email" class="glass-input" readonly>
                                    </div>
                                    <div class="form-group">
                                        <label>Staff Role</label>
                                        <input type="text" value="Super Admin" readonly class="glass-input"
                                            style="opacity: 0.6;">
                                    </div>
                                    <div class="form-group">
                                        <label>Last Login</label>
                                        <input type="text" id="adm-last-login" readonly class="glass-input"
                                            style="opacity: 0.6;">
                                    </div>
                                </div>
                                <button class="btn btn-gold" style="margin-top: 25px;">Update Admin Identity</button>
                            </div>
                        </div>
                    </div>

                    <!-- ADMIN SECURITY -->
                    <div id="admin-security-pane" class="settings-pane" style="display: none;">
                        <div class="settings-grid" style="grid-template-columns: 1fr 1.5fr;">
                            <div class="settings-card glass-panel">
                                <h3>Change Access Key</h3>
                                <div style="margin-top: 20px; display: flex; flex-direction: column; gap: 15px;">
                                    <div class="form-group">
                                        <label>Current Password</label>
                                        <input type="password" class="glass-input" placeholder="••••••••">
                                    </div>
                                    <div class="form-group">
                                        <label>New Administrative Password</label>
                                        <input type="password" class="glass-input" placeholder="Secure characters">
                                    </div>
                                    <button class="btn btn-gold full-width">Update Password</button>
                                </div>
                                <div class="settings-divider" style="margin: 20px 0;"></div>
                                <div style="display: flex; justify-content: space-between; align-items: center;">
                                    <span>2-Factor Auth</span>
                                    <button class="btn btn-outline small">Disabled</button>
                                </div>
                            </div>
                            <div class="settings-card glass-panel">
                                <div
                                    style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                                    <h3>Login Activity & History</h3>
                                    <button class="btn btn-danger small outline">Kill All Sessions</button>
                                </div>
                                <div class="activity-log-table">
                                    <div
                                        style="display: grid; grid-template-columns: 1fr 1fr 1fr; opacity: 0.5; font-size: 0.8rem; padding-bottom: 10px; border-bottom: 1px solid rgba(255,255,255,0.05);">
                                        <span>TIMESTAMP</span>
                                        <span>IP ADDRESS</span>
                                        <span>DEVICE / AGENT</span>
                                    </div>
                                    <div id="admin-login-logs" style="margin-top: 10px;">
                                        <p class="fade-text" style="font-size: 0.85rem; padding: 10px 0;">No suspicious
                                            activity detected. All sessions are secure.</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- STORE CONFIGURATION -->
                    <div id="store-config-pane" class="settings-pane" style="display: none;">
                        <div class="settings-card glass-panel">
                            <h3>Business Constants</h3>
                            <div class="form-grid"
                                style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin-top: 25px;">
                                <div class="form-group">
                                    <label>Store Global Name</label>
                                    <input type="text" value="EFV™ Official Store" class="glass-input">
                                </div>
                                <div class="form-group">
                                    <label>Support Hotline</label>
                                    <input type="text" value="+91 98765 43210" class="glass-input">
                                </div>
                                <div class="form-group">
                                    <label>Support Email</label>
                                    <input type="email" value="support@efv.com" class="glass-input">
                                </div>
                                <div class="form-group">
                                    <label>Base Currency</label>
                                    <select class="glass-input">
                                        <option>INR (₹)</option>
                                        <option>USD ($)</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label>Tax / GST (%)</label>
                                    <input type="number" value="18" class="glass-input">
                                </div>
                                <div class="form-group">
                                    <label>Invoice Prefix</label>
                                    <input type="text" value="EFV-2026-" class="glass-input">
                                </div>
                            </div>
                            <button class="btn btn-gold" style="margin-top: 25px;">Sync Store Settings</button>
                        </div>
                    </div>

                    <!-- ADMIN ALERTS -->
                    <div id="admin-alerts-pane" class="settings-pane" style="display: none;">
                        <div class="settings-card glass-panel" style="max-width: 600px;">
                            <h3>Real-time Admin Alerts</h3>
                            <p class="fade-text" style="margin-bottom: 25px;">Select which events trigger desktop and
                                email notifications for staff.</p>
                            <div style="display: flex; flex-direction: column; gap: 20px;">
                                <div
                                    style="display: flex; justify-content: space-between; align-items: center; padding: 10px; background: rgba(255,255,255,0.02); border-radius: 8px;">
                                    <span>New Order Placed</span>
                                    <div class="toggle-switch active"></div>
                                </div>
                                <div
                                    style="display: flex; justify-content: space-between; align-items: center; padding: 10px; background: rgba(255,255,255,0.02); border-radius: 8px;">
                                    <span>Payment Failure / Dispute</span>
                                    <div class="toggle-switch active"></div>
                                </div>
                                <div
                                    style="display: flex; justify-content: space-between; align-items: center; padding: 10px; background: rgba(255,255,255,0.02); border-radius: 8px;">
                                    <span>New User Registration</span>
                                    <div class="toggle-switch"></div>
                                </div>
                                <div
                                    style="display: flex; justify-content: space-between; align-items: center; padding: 10px; background: rgba(255,255,255,0.02); border-radius: 8px;">
                                    <span>Refund Request Received</span>
                                    <div class="toggle-switch active"></div>
                                </div>
                            </div>
                        </div>
                    </div>


                </div>
            </section>

            <!-- ADMIN PORTAL TAB (Home) -->
            <section id="admin" class="content-section">
                <header class="content-header">
                    <h1>Admin <span class="gold-text">Portal</span></h1>
                    <p>Management & Analytics Dashboard</p>
                </header>

                <div class="stats-grid" style="margin-bottom: 30px;">
                    <div class="stat-card glass-panel shine-hover">
                        <div class="icon-box gold"><i class="fas fa-boxes"></i></div>
                        <div class="stat-info">
                            <h3>Total Books</h3>
                            <span id="admin-stat-total-products" class="stat-value">0</span>
                        </div>
                    </div>
                    <div class="stat-card glass-panel shine-hover">
                        <div class="icon-box blue"><i class="fas fa-shopping-bag"></i></div>
                        <div class="stat-info">
                            <h3>Total Orders</h3>
                            <span id="admin-stat-total-orders" class="stat-value">0</span>
                        </div>
                    </div>
                    <div class="stat-card glass-panel shine-hover">
                        <div class="icon-box green"><i class="fas fa-coins"></i></div>
                        <div class="stat-info">
                            <h3>Total Revenue</h3>
                            <span id="admin-stat-revenue" class="stat-value">₹0</span>
                        </div>
                    </div>
                </div>

                <div class="admin-quick-actions grid-3"
                    style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px;">
                    <button class="stat-card glass-panel shine-hover"
                        style="cursor: pointer; border: none; text-align: left;" onclick="switchTab('admin-orders')">
                        <div class="icon-box blue"><i class="fas fa-shopping-cart"></i></div>
                        <div class="stat-info">
                            <h3>Manage Orders</h3>
                            <p>View & Update Orders</p>
                        </div>
                    </button>
                    <button class="stat-card glass-panel shine-hover"
                        style="cursor: pointer; border: none; text-align: left;" onclick="switchTab('admin-products')">
                        <div class="icon-box gold"><i class="fas fa-book"></i></div>
                        <div class="stat-info">
                            <h3>Manage Products</h3>
                            <p>Add & Edit Books</p>
                        </div>
                    </button>
                    <button class="stat-card glass-panel shine-hover"
                        style="cursor: pointer; border: none; text-align: left;" onclick="switchTab('admin-reports')">
                        <div class="icon-box green"><i class="fas fa-chart-bar"></i></div>
                        <div class="stat-info">
                            <h3>View Reports</h3>
                            <p>Sales & Growth Analytics</p>
                        </div>
                    </button>
                </div>
            </section>

            <!-- ORDERS MANAGEMENT PAGE -->
            <section id="admin-orders" class="content-section">
                <header class="content-header">
                    <h1>Orders <span class="gold-text">Management</span></h1>
                    <p>Track and manage customer purchases</p>
                </header>
                <div class="settings-card glass-panel" style="padding: 20px; overflow-x: auto;">
                    <table style="width: 100%; border-collapse: collapse; min-width: 1000px;">
                        <thead>
                            <tr style="border-bottom: 1px solid rgba(255,255,255,0.1); text-align: left;">
                                <th style="padding: 12px;">Order ID</th>
                                <th style="padding: 12px;">Date</th>
                                <th style="padding: 12px;">Customer</th>
                                <th style="padding: 12px;">Product(s)</th>
                                <th style="padding: 12px;">Amount</th>
                                <th style="padding: 12px;">Payment</th>
                                <th style="padding: 12px;">Status</th>
                                <th style="padding: 12px;">Action</th>
                            </tr>
                        </thead>
                        <tbody id="admin-orders-table-body">
                            <!-- Populated via JS -->
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- PRODUCT MANAGEMENT PAGE -->
            <section id="admin-products" class="content-section">
                <header class="content-header"
                    style="display: flex; justify-content: space-between; align-items: center;">
                    <div>
                        <h1>Product <span class="gold-text">Management</span></h1>
                        <p>Manage your inventory of books</p>
                    </div>
                    <button class="btn btn-gold" onclick="window.openAddProductModal()">+ Add New Product</button>
                </header>
                <div class="admin-controls glass-panel"
                    style="margin-bottom: 20px; padding: 15px; display: flex; gap: 15px; align-items: center; flex-wrap: wrap;">
                    <div class="search-box" style="flex: 1; min-width: 250px; position: relative;">
                        <i class="fas fa-search"
                            style="position: absolute; left: 15px; top: 50%; transform: translateY(-50%); opacity: 0.5;"></i>
                        <input type="text" id="admin-product-search" placeholder="Search by title or author..."
                            oninput="filterAdminProducts()"
                            style="width: 100%; padding: 10px 15px 10px 45px; background: rgba(0,0,0,0.3); border: 1px solid rgba(255,255,255,0.1); border-radius: 8px; color: white;">
                    </div>
                    <div class="filter-group" style="display: flex; gap: 10px;">
                        <select id="admin-product-filter-type" onchange="filterAdminProducts()"
                            style="padding: 10px; background: rgba(0,0,0,0.3); border: 1px solid rgba(255,255,255,0.1); border-radius: 8px; color: white;">
                            <option value="all">All Types</option>
                            <option value="physical">Physical Books</option>
                            <option value="EBOOK">E-books</option>
                            <option value="AUDIOBOOK">Audiobooks</option>
                        </select>
                        <select id="admin-product-filter-stock" onchange="filterAdminProducts()"
                            style="padding: 10px; background: rgba(0,0,0,0.3); border: 1px solid rgba(255,255,255,0.1); border-radius: 8px; color: white;">
                            <option value="all">All Stock</option>
                            <option value="instock">In Stock</option>
                            <option value="outofstock">Out of Stock</option>
                        </select>
                    </div>
                </div>
                <div class="settings-card glass-panel" style="padding: 20px; overflow-x: auto;">
                    <table style="width: 100%; border-collapse: collapse; min-width: 800px;">
                        <thead>
                            <tr style="border-bottom: 1px solid rgba(255,255,255,0.1); text-align: left;">
                                <th style="padding: 12px;">Image</th>
                                <th style="padding: 12px;">Title</th>
                                <th style="padding: 12px;">Type</th>
                                <th style="padding: 12px;">Price</th>
                                <th style="padding: 12px;">Media</th>
                                <th style="padding: 12px;">Stock</th>
                                <th style="padding: 12px;">Actions</th>
                            </tr>
                        </thead>
                        <tbody id="admin-product-table-body-full">
                            <!-- Populated via JS -->
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- CUSTOMERS PAGE -->
            <section id="admin-customers" class="content-section">
                <header class="content-header">
                    <h1>Customer <span class="gold-text">Database</span></h1>
                    <p>View and manage registered users</p>
                </header>
                <div class="settings-card glass-panel" style="padding: 20px; overflow-x: auto;">
                    <table style="width: 100%; border-collapse: collapse;">
                        <thead>
                            <tr style="border-bottom: 1px solid rgba(255,255,255,0.1); text-align: left;">
                                <th style="padding: 12px;">Name</th>
                                <th style="padding: 12px;">Email</th>
                                <th style="padding: 12px;">Phone</th>
                                <th style="padding: 12px;">Orders</th>
                                <th style="padding: 12px;">Spent</th>
                                <th style="padding: 12px;">Action</th>
                            </tr>
                        </thead>
                        <tbody id="admin-customers-table-body">
                            <!-- Dummy Data -->
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- PAYMENTS PAGE -->
            <section id="admin-payments" class="content-section">
                <header class="content-header">
                    <h1>Payment <span class="gold-text">Records</span></h1>
                    <p>Financial transaction logs</p>
                </header>
                <div class="settings-card glass-panel" style="padding: 20px; overflow-x: auto;">
                    <table style="width: 100%; border-collapse: collapse;">
                        <thead>
                            <tr style="border-bottom: 1px solid rgba(255,255,255,0.1); text-align: left;">
                                <th style="padding: 12px;">Payment ID</th>
                                <th style="padding: 12px;">Order ID</th>
                                <th style="padding: 12px;">Amount</th>
                                <th style="padding: 12px;">Method</th>
                                <th style="padding: 12px;">Status</th>
                                <th style="padding: 12px;">Date</th>
                            </tr>
                        </thead>
                        <tbody id="admin-payments-table-body">
                            <!-- Dummy Data -->
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- SHIPMENTS PAGE -->
            <section id="admin-shipments" class="content-section">
                <header class="content-header">
                    <h1>Shipment <span class="gold-text">Logs</span></h1>
                    <p>Logistics and tracking management</p>
                </header>
                <div class="settings-card glass-panel" style="padding: 20px; overflow-x: auto;">
                    <table style="width: 100%; border-collapse: collapse;">
                        <thead>
                            <tr style="border-bottom: 1px solid rgba(255,255,255,0.1); text-align: left;">
                                <th style="padding: 12px;">Order ID</th>
                                <th style="padding: 12px;">Courier</th>
                                <th style="padding: 12px;">AWB Number</th>
                                <th style="padding: 12px;">Status</th>
                                <th style="padding: 12px;">Label</th>
                                <th style="padding: 12px;">Tracking</th>
                            </tr>
                        </thead>
                        <tbody id="admin-shipments-table-body">
                            <!-- Shiprocket Placeholders -->
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- COUPONS PAGE -->
            <section id="admin-coupons" class="content-section">
                <header class="content-header"
                    style="display: flex; justify-content: space-between; align-items: center;">
                    <div>
                        <h1>Coupon <span class="gold-text">Manager</span></h1>
                        <p>Create and manage discount codes</p>
                    </div>
                    <button class="btn btn-gold small" onclick="alert('Coupon creator coming soon')">+ New
                        Coupon</button>
                </header>
                <div class="settings-card glass-panel" style="padding: 20px;">
                    <table style="width: 100%; border-collapse: collapse;">
                        <thead>
                            <tr style="border-bottom: 1px solid rgba(255,255,255,0.1); text-align: left;">
                                <th style="padding: 12px;">Code</th>
                                <th style="padding: 12px;">Type</th>
                                <th style="padding: 12px;">Value</th>
                                <th style="padding: 12px;">Usage</th>
                                <th style="padding: 12px;">Expires</th>
                                <th style="padding: 12px;">Status</th>
                            </tr>
                        </thead>
                        <tbody id="admin-coupons-table-body">
                            <!-- Coupons go here -->
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- REPORTS PAGE -->
            <section id="admin-reports" class="content-section">
                <!-- ... existing reports content ... -->
            </section>

            <!-- WISHLIST TAB -->
            <section id="wishlist" class="content-section">
                <header class="content-header">
                    <h1>My <span class="gold-text">Wishlist</span></h1>
                    <p>Items you've saved for later</p>
                </header>
                <div id="wishlist-items-grid" class="items-grid">
                    <p class="fade-text" style="grid-column: 1/-1; padding: 40px; text-align: center;">Your wishlist is
                        empty.</p>
                </div>
            </section>

            <!-- PAYMENTS TAB (DASHBOARD VERSION) -->
            <section id="payments" class="content-section">
                <header class="content-header">
                    <h1>Payments & <span class="gold-text">Billing</span></h1>
                    <p>Manage your payment methods and view history</p>
                </header>
                <div class="settings-card glass-panel">
                    <div style="text-align: center; padding: 40px;">
                        <i class="fas fa-credit-card"
                            style="font-size: 3rem; color: var(--gold-text); opacity: 0.2; margin-bottom: 20px;"></i>
                        <h3>No payment methods saved</h3>
                        <p class="fade-text">Save your card details during checkout for faster payments.</p>
                    </div>
                </div>
            </section>

            <!-- ADDRESSES TAB (REDIRECTS TO SETTINGS > ADDRESSES) -->
            <section id="addresses" class="content-section">
                <!-- This will be handled by switchTab('settings') and opening the address sub-tab -->
            </section>

            <!-- HELP & SUPPORT TAB -->
            <section id="support" class="content-section">
                <header class="content-header">
                    <h1>Help & <span class="gold-text">Support</span></h1>
                    <p>We're here to help you</p>
                </header>
                <div class="settings-grid">
                    <div class="settings-card glass-panel">
                        <div class="settings-header">
                            <div class="icon-box gold"><i class="fas fa-question-circle"></i></div>
                            <h3>FAQs</h3>
                        </div>
                        <div class="faq-list">
                            <details style="padding: 10px 0; border-bottom: 1px solid rgba(255,255,255,0.05);">
                                <summary style="cursor: pointer; font-weight: 600;">How to access my digital books?
                                </summary>
                                <p style="padding-top: 10px; font-size: 0.9rem; opacity: 0.7;">Go to "My Library" and
                                    click on the "Read Now" or "Listen Now" button next to your book. Your progress will
                                    be saved automatically.</p>
                            </details>
                            <details style="padding: 10px 0; border-bottom: 1px solid rgba(255,255,255,0.05);">
                                <summary style="cursor: pointer; font-weight: 600;">Can I get a refund for my order?
                                </summary>
                                <p style="padding-top: 10px; font-size: 0.9rem; opacity: 0.7;">Digital products are
                                    non-refundable after access. For physical books, you can request a return within 7
                                    days.</p>
                            </details>
                        </div>
                    </div>
                    <div class="settings-card glass-panel">
                        <div class="settings-header">
                            <div class="icon-box blue"><i class="fas fa-envelope-open-text"></i></div>
                            <h3>Contact Us</h3>
                        </div>
                        <p style="margin-bottom: 20px;">Need more help? Our support team is available 24/7.</p>
                        <button class="btn btn-gold full-width" onclick="location.href='contact.html'">Start Live
                            Chat</button>
                        <button class="btn btn-outline full-width" style="margin-top: 10px;"
                            onclick="location.href='mailto:support@efv.com'">Email Support</button>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Product Management Modal (Redesigned) -->
    <div id="admin-product-modal" class="admin-premium-overlay" style="z-index: 100000;">
        <canvas class="modal-particles" id="modal-particles-canvas"></canvas>
        <div class="admin-premium-card">
            <div class="modal-header-premium">
                <h2 id="admin-modal-title">ADD NEW PRODUCT</h2>
                <button onclick="closeProductModal()" class="close-premium">&times;</button>
            </div>

            <div class="modal-main-content">
                <form id="admin-product-form">
                    <input type="hidden" id="admin-prod-id">

                    <!-- Section 1: Product Info -->
                    <div class="form-section-header">
                        <i class="fas fa-info-circle"></i>
                        <h3>Product Information</h3>
                    </div>
                    <div class="premium-grid">
                        <div class="p-form-group">
                            <input type="text" id="admin-prod-title" class="p-input" placeholder=" " required>
                            <label class="p-label">Book Title</label>
                        </div>
                        <div class="p-form-group">
                            <input type="text" id="admin-prod-author" class="p-input" placeholder=" "
                                value="EFV Authorized Member">
                            <label class="p-label">Author Name</label>
                        </div>
                    </div>

                    <div class="premium-grid" style="grid-template-columns: repeat(3, 1fr);">
                        <div class="p-form-group">
                            <select id="admin-prod-type" class="p-input" onchange="toggleAdminFileFields()" required>
                                <option value="HARDCOVER">Hardcover</option>
                                <option value="PAPERBACK">Paperback</option>
                                <option value="EBOOK">E-book</option>
                                <option value="AUDIOBOOK">Audiobook</option>
                            </select>
                            <label class="p-label">Category</label>
                        </div>
                        <div class="p-form-group">
                            <select id="admin-prod-lang" class="p-input">
                                <option value="Hindi">Hindi</option>
                                <option value="English">English</option>
                            </select>
                            <label class="p-label">Language</label>
                        </div>
                        <div class="p-form-group">
                            <input type="number" id="admin-prod-volume" class="p-input" placeholder=" ">
                            <label class="p-label">Volume No.</label>
                        </div>
                    </div>

                    <div class="premium-grid" style="grid-template-columns: repeat(3, 1fr);">
                        <div class="p-form-group">
                            <input type="number" id="admin-prod-price" class="p-input" placeholder=" " required>
                            <label class="p-label">Price (₹)</label>
                        </div>
                        <div class="p-form-group">
                            <input type="number" id="admin-prod-discount-price" class="p-input" placeholder=" ">
                            <label class="p-label">Discount Price (₹)</label>
                        </div>
                        <div class="p-form-group">
                            <input type="number" id="admin-prod-stock" class="p-input" placeholder=" ">
                            <label class="p-label">Stock Qty</label>
                        </div>
                    </div>

                    <div class="p-form-group">
                        <textarea id="admin-prod-desc" class="p-input" placeholder=" "></textarea>
                        <label class="p-label">Description</label>
                    </div>

                    <!-- Section 2: Dimensions & Weight -->
                    <div class="form-section-header admin-physical-field">
                        <i class="fas fa-ruler-combined"></i>
                        <h3>Dimensions & Weight</h3>
                    </div>
                    <div class="premium-grid admin-physical-field" style="grid-template-columns: repeat(4, 1fr);">
                        <div class="p-form-group">
                            <input type="number" id="admin-prod-weight" class="p-input" placeholder=" ">
                            <label class="p-label">Weight(g)</label>
                        </div>
                        <div class="p-form-group">
                            <input type="number" id="admin-prod-length" class="p-input" placeholder=" ">
                            <label class="p-label">Length(cm)</label>
                        </div>
                        <div class="p-form-group">
                            <input type="number" id="admin-prod-width" class="p-input" placeholder=" ">
                            <label class="p-label">Width(cm)</label>
                        </div>
                        <div class="p-form-group">
                            <input type="number" id="admin-prod-height" class="p-input" placeholder=" ">
                            <label class="p-label">Height(cm)</label>
                        </div>
                    </div>

                    <!-- Section 3: Media Upload -->
                    <div class="form-section-header">
                        <i class="fas fa-photo-video"></i>
                        <h3>Media Assets</h3>
                    </div>
                    <div class="upload-container">
                        <div class="drop-zone" id="drop-zone-cover">
                            <i class="fas fa-cloud-upload-alt"></i>
                            <span><b>Cover Image</b><br>Click or drag image here</span>
                            <input type="file" id="admin-file-cover" accept="image/*">
                            <div class="file-preview" id="admin-current-cover"></div>
                        </div>
                        <div class="drop-zone" id="drop-zone-gallery">
                            <i class="fas fa-images"></i>
                            <span><b>Gallery Images</b><br>Add multiple images</span>
                            <input type="file" id="admin-file-gallery" multiple accept="image/*">
                            <div class="file-preview" id="admin-current-gallery"></div>
                        </div>
                    </div>

                    <!-- Section 4: Digital Details -->
                    <div id="admin-field-ebook" style="display: none;">
                        <div class="form-section-header">
                            <i class="fas fa-file-pdf"></i>
                            <h3>E-Book Document</h3>
                        </div>
                        <div class="drop-zone" style="min-height: 80px;">
                            <i class="fas fa-file-contract"></i>
                            <span><b>Digital Publication</b><br>Upload PDF / EPUB</span>
                            <input type="file" id="admin-file-ebook"
                                accept=".pdf,.epub,.mobi,.doc,.docx,.txt,.rtf,.odt,.html,.azw,.azw3,.fb2">
                            <div class="file-preview" id="admin-current-ebook"></div>
                        </div>
                    </div>

                    <div id="admin-field-audio" style="display: none;">
                        <div class="form-section-header">
                            <i class="fas fa-microphone-alt"></i>
                            <h3>Audiobook Details</h3>
                        </div>
                        <div class="premium-grid">
                            <div class="p-form-group">
                                <input type="text" id="admin-prod-duration" class="p-input" placeholder=" ">
                                <label class="p-label">Duration (e.g. 12:45)</label>
                            </div>
                            <div class="drop-zone" style="min-height: 80px;">
                                <i class="fas fa-volume-up"></i>
                                <span><b>Audio File</b><br>Upload MP3 / M4A</span>
                                <input type="file" id="admin-file-audio"
                                    accept="audio/*,video/*,.mp3,.wav,.m4a,.aac,.flac,.ogg,.wma,.opus">
                                <div class="file-preview" id="admin-current-audio"></div>
                            </div>
                        </div>
                    </div>
                </form>
            </div>

            <div class="modal-footer-premium">
                <button type="button" onclick="closeProductModal()" class="p-btn p-btn-secondary">Cancel</button>
                <button type="submit" form="admin-product-form" class="p-btn p-btn-primary" id="admin-save-btn">
                    <i class="fas fa-save"></i> UPLOAD & SAVE PRODUCT
                </button>
            </div>
        </div>
    </div>

    <!-- Order Detail Modal -->
    <div id="order-detail-modal" class="resume-modal-overlay" style="z-index: 100001; display: none;">
        <div class="resume-modal glass-panel" style="max-width: 800px; width: 95%;">
            <div
                style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; border-bottom: 1px solid rgba(255,255,255,0.1); padding-bottom: 15px;">
                <div>
                    <h2 style="margin: 0; color: var(--gold-text);">Order <span id="modal-order-id">#ORD-123456</span>
                    </h2>
                    <p id="modal-order-date" style="margin: 5px 0 0; opacity: 0.6; font-size: 0.9rem;">Placed on: Feb
                        19, 2026</p>
                </div>
                <button onclick="closeOrderDetailModal()"
                    style="background: none; border: none; color: white; font-size: 1.5rem; cursor: pointer;">&times;</button>
            </div>

            <div class="order-detail-content"
                style="display: grid; grid-template-columns: 1.5fr 1fr; gap: 25px; text-align: left;">
                <div class="detail-left">
                    <h3 style="font-size: 1.1rem; margin-bottom: 15px;">Ordered Items</h3>
                    <div id="modal-order-items"
                        style="display: flex; flex-direction: column; gap: 12px; margin-bottom: 30px;">
                        <!-- Items injected here -->
                    </div>

                    <h3 style="font-size: 1.1rem; margin-bottom: 15px;">Order Tracking</h3>
                    <div class="order-timeline" id="modal-order-timeline" style="margin-bottom: 20px;">
                        <!-- Timeline steps -->
                    </div>
                </div>

                <div class="detail-right">
                    <div class="glass-panel" style="padding: 15px; background: rgba(0,0,0,0.2); margin-bottom: 15px;">
                        <h4 style="margin-top: 0; border-bottom: 1px solid rgba(255,255,255,0.1); padding-bottom: 8px;">
                            Shipping Address</h4>
                        <div id="modal-shipping-address" style="font-size: 0.9rem; line-height: 1.5; opacity: 0.8;">
                            <!-- Address injected here -->
                        </div>
                    </div>

                    <div class="glass-panel" style="padding: 15px; background: rgba(0,0,0,0.2);">
                        <h4 style="margin-top: 0; border-bottom: 1px solid rgba(255,255,255,0.1); padding-bottom: 8px;">
                            Order Summary</h4>
                        <div style="display: flex; flex-direction: column; gap: 8px; font-size: 0.9rem;">
                            <div style="display: flex; justify-content: space-between; opacity: 0.7;">
                                <span>Subtotal</span><span id="modal-subtotal">₹0</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; opacity: 0.7;">
                                <span>Shipping</span><span id="modal-shipping">₹0</span>
                            </div>
                            <div
                                style="display: flex; justify-content: space-between; font-weight: bold; border-top: 1px solid rgba(255,255,255,0.1); padding-top: 8px; margin-top: 5px; color: var(--gold-text);">
                                <span>Total</span><span id="modal-total">₹0</span>
                            </div>
                            <div style="margin-top: 10px; font-size: 0.8rem; opacity: 0.6;">
                                <p>Payment Method: <span id="modal-payment-method">Razorpay</span></p>
                                <p>Status: <span id="modal-payment-status" class="gold-text">Paid</span></p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Address Modal -->
    <div id="address-modal" class="resume-modal-overlay" style="z-index: 100005;">
        <div class="resume-modal glass-panel" style="max-width: 550px; width: 95%; text-align: left;">
            <div
                style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px; border-bottom: 1px solid rgba(255,255,255,0.1); padding-bottom: 15px;">
                <h2 id="address-modal-title" style="margin: 0; color: var(--gold-text); font-family: 'Cinzel';">Add New
                    Address</h2>
                <button onclick="closeAddressModal()"
                    style="background: none; border: none; color: white; font-size: 1.5rem; cursor: pointer; opacity: 0.5; transition: 0.3s;"
                    onmouseover="this.style.opacity=1" onmouseout="this.style.opacity=0.5">&times;</button>
            </div>

            <form id="address-form" style="display: flex; flex-direction: column; gap: 18px;">
                <input type="hidden" id="address-id">

                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                    <div class="form-group">
                        <label>Full Name</label>
                        <div class="input-wrapper">
                            <i class="fas fa-user"></i>
                            <input type="text" id="addr-name" placeholder="Receiver's Name" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Phone Number</label>
                        <div class="input-wrapper">
                            <i class="fas fa-phone"></i>
                            <input type="tel" id="addr-phone" placeholder="10-digit mobile" required>
                        </div>
                    </div>
                </div>

                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                    <div class="form-group">
                        <label>Pincode</label>
                        <div class="input-wrapper">
                            <i class="fas fa-map-pin"></i>
                            <input type="text" id="addr-pincode" placeholder="6-digit code" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>State</label>
                        <div class="input-wrapper">
                            <i class="fas fa-map"></i>
                            <input type="text" id="addr-state" placeholder="State" required>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label>City / District</label>
                    <div class="input-wrapper">
                        <i class="fas fa-city"></i>
                        <input type="text" id="addr-city" placeholder="City" required>
                    </div>
                </div>

                <div class="form-group">
                    <label>House No., Building, Area</label>
                    <textarea id="addr-full" rows="3" placeholder="Full Address Details" required
                        style="padding-left: 15px !important;"></textarea>
                </div>

                <div class="form-group">
                    <label>Landmark (Optional)</label>
                    <div class="input-wrapper">
                        <i class="fas fa-monument"></i>
                        <input type="text" id="addr-landmark" placeholder="Near XYZ...">
                    </div>
                </div>

                <div
                    style="display: flex; align-items: center; gap: 12px; margin: 10px 0; background: rgba(255,255,255,0.03); padding: 12px; border-radius: 8px;">
                    <input type="checkbox" id="addr-default"
                        style="width: 20px; height: 20px; cursor: pointer; accent-color: var(--gold-text);">
                    <label for="addr-default" style="margin: 0; cursor: pointer; user-select: none;">Set as my default
                        shipping address</label>
                </div>

                <div style="display: flex; gap: 15px; margin-top: 10px;">
                    <button type="submit" class="btn btn-gold full-width" style="height: 50px;">Save & Use
                        Address</button>
                    <button type="button" onclick="closeAddressModal()" class="btn btn-outline"
                        style="width: 150px;">Cancel</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://checkout.razorpay.com/v1/checkout.js"></script>
    <script src="js/api-config.js"></script>
    <script src="js/profile.js"></script>
    <script src="js/security.js"></script>
</body>

</html>